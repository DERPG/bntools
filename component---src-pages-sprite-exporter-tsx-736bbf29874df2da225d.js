(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{FiuD:function(r,e,t){"use strict";function a(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}t.r(e);var n=t("dI71"),i=t("q1tI"),o=t.n(i),s=function(){function r(r){this.array=r}var e=r.prototype;return e.read8=function(r){return this.array[r]},e.read16=function(r){return this.array[r]+(this.array[r+1]<<8)},e.read32=function(r){return this.array[r]+(this.array[r+1]<<8)+(this.array[r+2]<<16)+(this.array[r+3]<<24)},r}(),u=function(){function r(r){this.data=r,this.cursor=0,this.base=0}var e=r.prototype;return e.reset=function(r,e){this.base=r,this.cursor=e},e.setCursor=function(r){this.cursor=r},e.read8=function(){var r=this.data.read8(this.base+this.cursor);return this.cursor+=1,r},e.read16=function(){var r=this.data.read16(this.base+this.cursor);return this.cursor+=2,r},e.read32=function(){var r=this.data.read32(this.base+this.cursor);return this.cursor+=4,r},r}(),d=function(r,e,t){this.tilemap=r,this.palette=e,this.oams=t},f=function(r){this.tiles=r},h=function(){function r(r,e){this.width=r,this.height=e}return r.prototype.total=function(){return this.width*this.height},r}(),c=[new h(1,1),new h(2,2),new h(4,4),new h(8,8),new h(2,1),new h(4,1),new h(4,2),new h(8,2),new h(1,2),new h(1,4),new h(2,4),new h(4,8)],l=function(){function r(r){this.array=r}var e=r.prototype;return e.value=function(r){return this.array[r]},e.high=function(r){var e=this.value(r);return[31&e,(992&e)>>5,(31744&e)>>10]},e.true=function(r){return this.high(r).map((function(r){return 8*r}))},r}();function v(r){for(var e=r.read32()/32,t=new Array(e),a=0;a<e;a++){for(var n=new Array(64),i=0;i<32;i++){var o=r.read8(),s=15&o,u=(240&o)>>4;n[2*i]=s,n[2*i+1]=u}t[a]=n}return new f(t)}function w(r){r.read32();for(var e=new Array(16),t=0;t<16;t++)e[t]=r.read16();return new l(e)}function p(r){for(var e=[],t=r.read32()-4,a=0;a<t;a++)r.read8();for(;;){var n=r.read8(),i=r.read8(),o=r.read8(),s=r.read8(),u=r.read8();if(255===n&&255===i&&255===o&&255===s&&255===u)break;var d={startTile:n,offsetX:i,offsetY:o,size:c[((3&u)<<2)+(3&s)]};e.push(d)}return e}var y=function(r){function e(e){var t;return(t=r.call(this,e)||this).state={image:null},t.canvasRef=o.a.createRef(),t.loadFile=t.loadFile.bind(a(t)),t.load=t.load.bind(a(t)),t.readSprite=t.readSprite.bind(a(t)),t}Object(n.a)(e,r);var t=e.prototype;return t.loadFile=function(r){var e=this;console.log("loaded file");var t=new FileReader;t.readAsArrayBuffer(r.target.files[0]),t.onloadend=function(r){var t=new Uint8Array(r.target.result),a=new s(t);e.data=a,e.load(3928708)}},t.load=function(r){var e=this.canvasRef.current,t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),function(r,e){var t=new u(r);t.setCursor(e),t.read8(),t.read8(),t.read8();var a=t.read8(),n=new Array(a),i=(new Array(a),new Array(256));t.reset(e+4,0);for(var o=0;o<a;o++)n[o]=t.read32();for(var s=0;s<a;s++){t.setCursor(n[s]);var f=t.read32(),h=t.read32(),c=(t.read32(),t.read32());t.read8();t.read8();t.read8();t.read8(),t.setCursor(f);var l=v(t);t.setCursor(h);var y=w(t);t.setCursor(c);var g=p(t);i[s]=new d(l,y,g)}return i}(this.data,r).forEach((function(r,e){var a=r.palette;r.oams.forEach((function(n){console.log(n);var i=0,o=0,s=0,u=0;s=n.offsetX<=127?128+n.offsetX:n.offsetX-128,console.log(s),u=n.offsetY<=127?128+n.offsetY:n.offsetY-128;for(var d=0;d<n.size.total();d++){for(var f=n.startTile+d,h=s+8*i+e%8*64,c=64*Math.floor(e/8)+u+8*o,l=t.getImageData(h,c,8,8),v=0;v<64;v++){var w=4*v,p=r.tilemap.tiles[f][v];if(0!==p){var y=a.true(p);l.data[w]=y[0],l.data[w+1]=y[1],l.data[w+2]=y[2],l.data[w+3]=255}}t.putImageData(l,h,c),++i>=n.size.width&&(o++,i=0)}}))}))},t.readSprite=function(r){var e=r.target.value,t=16777215&this.data.read32(204456+4*e);this.load(t)},t.render=function(){return o.a.createElement("div",null,o.a.createElement("h2",null,"Sprite exporter"),o.a.createElement("input",{type:"file",onChange:this.loadFile}),o.a.createElement("input",{type:"number",onChange:this.readSprite,defaultValue:0}),o.a.createElement("canvas",{ref:this.canvasRef,width:1024,height:512}))},e}(o.a.Component);e.default=y}}]);
//# sourceMappingURL=component---src-pages-sprite-exporter-tsx-736bbf29874df2da225d.js.map